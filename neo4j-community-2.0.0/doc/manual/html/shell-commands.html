<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>28.6. How to use (individual commands)</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.76.1" /><link rel="home" href="index.html" title="The Neo4j Manual v2.0.0" /><link rel="up" href="shell.html" title="Chapter 28. Neo4j Shell" /><link rel="prev" href="shell-titles.html" title="28.5. Node titles" /><link rel="next" href="shell-sample-session.html" title="28.7. An example shell session" /><link rel="preface" href="preface.html" title="Preface" /><link rel="part" href="introduction.html" title="Part I. Introduction" /><link rel="chapter" href="introduction-highlights.html" title="Chapter 1. Neo4j Highlights" /><link rel="chapter" href="graphdb-concepts.html" title="Chapter 2. Graph Database Concepts" /><link rel="chapter" href="graphdb-neo4j.html" title="Chapter 3. The Neo4j Graph Database" /><link rel="part" href="tutorials.html" title="Part II. Tutorials" /><link rel="chapter" href="tutorials-cypher.html" title="Chapter 4. Getting started with Cypher" /><link rel="chapter" href="data-modeling-examples.html" title="Chapter 5. Data Modeling Examples" /><link rel="chapter" href="languages.html" title="Chapter 6. Languages" /><link rel="part" href="cypher-query-lang.html" title="Part III. Cypher Query Language" /><link rel="chapter" href="cypher-intro.html" title="Chapter 7. Introduction" /><link rel="chapter" href="query-syntax.html" title="Chapter 8. Syntax" /><link rel="chapter" href="query-general.html" title="Chapter 9. General Clauses" /><link rel="chapter" href="query-read.html" title="Chapter 10. Reading Clauses" /><link rel="chapter" href="query-write.html" title="Chapter 11. Writing Clauses" /><link rel="chapter" href="query-function.html" title="Chapter 12. Functions" /><link rel="chapter" href="cypher-schema.html" title="Chapter 13. Schema" /><link rel="chapter" href="examples-from-sql-to-cypher.html" title="Chapter 14. From SQL to Cypher" /><link rel="part" href="reference-documentation.html" title="Part IV. Reference" /><link rel="chapter" href="capabilities.html" title="Chapter 15. Capabilities" /><link rel="chapter" href="transactions.html" title="Chapter 16. Transaction Management" /><link rel="chapter" href="import.html" title="Chapter 17. Data Import" /><link rel="chapter" href="graph-algo.html" title="Chapter 18. Graph Algorithms" /><link rel="chapter" href="rest-api.html" title="Chapter 19. REST API" /><link rel="chapter" href="deprecations.html" title="Chapter 20. Deprecations" /><link rel="part" href="operations.html" title="Part V. Operations" /><link rel="chapter" href="deployment.html" title="Chapter 21. Installation &amp; Deployment" /><link rel="chapter" href="embedded-configuration.html" title="Chapter 22. Configuration &amp; Performance" /><link rel="chapter" href="ha.html" title="Chapter 23. High Availability" /><link rel="chapter" href="operations-backup.html" title="Chapter 24. Backup" /><link rel="chapter" href="operations-security.html" title="Chapter 25. Security" /><link rel="chapter" href="operations-monitoring.html" title="Chapter 26. Monitoring" /><link rel="part" href="tools.html" title="Part VI. Tools" /><link rel="chapter" href="tools-webadmin.html" title="Chapter 27. Web Interface" /><link rel="chapter" href="shell.html" title="Chapter 28. Neo4j Shell" /><link rel="part" href="community.html" title="Part VII. Community" /><link rel="chapter" href="community-support.html" title="Chapter 29. Community Support" /><link rel="chapter" href="community-contributing.html" title="Chapter 30. Contributing to Neo4j" /><link rel="part" href="advanced-usage.html" title="Part VIII. Advanced Usage" /><link rel="chapter" href="server-extending.html" title="Chapter 31. Extending the Neo4j Server" /><link rel="chapter" href="tutorials-java-embedded.html" title="Chapter 32. Using Neo4j embedded in Java applications" /><link rel="chapter" href="tutorial-traversal.html" title="Chapter 33. The Traversal Framework" /><link rel="chapter" href="indexing.html" title="Chapter 34. Legacy Indexing" /><link rel="chapter" href="batchinsert.html" title="Chapter 35. Batch Insertion" /><link rel="appendix" href="manpages.html" title="Appendix A. Manpages" /><link rel="refentry" href="re01.html" title="neo4j" /><link rel="refentry" href="re02.html" title="neo4j-installer" /><link rel="refentry" href="re03.html" title="neo4j-shell" /><link rel="refentry" href="re04.html" title="neo4j-backup" /><link rel="refentry" href="re05.html" title="neo4j-arbiter" /><link rel="subsection" href="shell-commands.html#comments" title="28.6.1. Comments" /><link rel="subsection" href="shell-commands.html#shell-current-pos" title="28.6.2. Current node/relationship and path" /><link rel="subsection" href="shell-commands.html#shell-listing" title="28.6.3. Listing the contents of a node/relationship" /><link rel="subsection" href="shell-commands.html#_creating_nodes_and_relationships" title="28.6.4. Creating nodes and relationships" /><link rel="subsection" href="shell-commands.html#_setting_renaming_and_removing_properties" title="28.6.5. Setting, renaming and removing properties" /><link rel="subsection" href="shell-commands.html#_deleting_nodes_and_relationships" title="28.6.6. Deleting nodes and relationships" /><link rel="subsection" href="shell-commands.html#shell-env-vars" title="28.6.7. Environment variables" /><link rel="subsection" href="shell-commands.html#_executing_groovy_python_scripts" title="28.6.8. Executing groovy/python scripts" /><link rel="subsection" href="shell-commands.html#_traverse" title="28.6.9. Traverse" /><link rel="subsection" href="shell-commands.html#_query_with_cypher" title="28.6.10. Query with Cypher" /><link rel="subsection" href="shell-commands.html#shell-listing-indexes-and-constraints" title="28.6.11. Listing Indexes and Constraints" /><link rel="subsection" href="shell-commands.html#shell-legacy-indexing" title="28.6.12. Legacy Indexing" /><link rel="subsection" href="shell-commands.html#_transactions" title="28.6.13. Transactions" /><link rel="subsection" href="shell-commands.html#_dumping_the_database_or_a_cypher_result_to_cypher_statements" title="28.6.14. Dumping the database or a cypher result to Cypher statements" /><link rel="copyright" href="ln-idp218960.html" title="License: Creative Commons 3.0" />


<!-- favicon -->

<link rel="shortcut icon" href="http://neo4j.org/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="icon" href="http://neo4j.org/favicon.ico" type="image/x-icon" />

<!-- style -->

<link href="css/shCore.css" rel="stylesheet" type="text/css" />
<link href="css/shCoreEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/shThemeEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/neo.css" rel="stylesheet" type="text/css" />

<!-- Syntax Highlighter -->

<script type="text/javascript" src="js/shCore.js"></script>
<script type="text/javascript" src="js/shBrushJava.js"></script>
<script type="text/javascript" src="js/shBrushJScript.js"></script>
<script type="text/javascript" src="js/shBrushBash.js"></script>
<script type="text/javascript" src="js/shBrushPlain.js"></script>
<script type="text/javascript" src="js/shBrushXml.js"></script>
<script type="text/javascript" src="js/shBrushGroovy.js"></script>
<script type="text/javascript" src="js/shBrushCypher.js"></script>
<script type="text/javascript" src="js/shBrushScala.js"></script>
<script type="text/javascript" src="js/shBrushSql.js"></script>
<script type="text/javascript" src="js/shBrushPython.js"></script>
<script type="text/javascript" src="js/shBrushProperties.js"></script>

<!-- activate when needed
<script type="text/javascript" src="js/shBrushRuby.js"></script>
<script type="text/javascript" src="js/shBrushCSharp.js"></script>
-->
 
<script type="text/javascript">
  SyntaxHighlighter.defaults['tab-size'] = 4;
  SyntaxHighlighter.defaults['gutter'] = false;
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all()
</script>

<!-- JQuery -->

<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>

<!-- Replace SVG for browsers that lack support. -->
<script type="text/javascript" src="js/svgreplacer.js"></script>

<!-- Image Scaler -->

<script type="text/javascript" src="js/imagescaler.js"></script>

<!-- Table Styler -->

<script type="text/javascript" src="js/tablestyler.js"></script>

<!-- Version -->

<script type="text/javascript" src="js/version.js"></script>

<!-- Offline Sidebar -->

<script type="text/javascript" src="js/sidebar.js"></script>


<div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">The Neo4j Manual</a></span> &gt; <span class="breadcrumb-link"><a href="tools.html">Tools</a></span> &gt; <span class="breadcrumb-link"><a href="shell.html">Neo4j Shell</a></span> &gt; <span class="breadcrumb-node">How to use (individual commands)</span></div></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="shell-titles.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="shell-sample-session.html">Next</a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="shell-commands"></a>28.6. How to use (individual commands)</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="shell-commands.html#comments">28.6.1. Comments</a></span></dt><dt><span class="section"><a href="shell-commands.html#shell-current-pos">28.6.2. Current node/relationship and path</a></span></dt><dt><span class="section"><a href="shell-commands.html#shell-listing">28.6.3. Listing the contents of a node/relationship</a></span></dt><dt><span class="section"><a href="shell-commands.html#_creating_nodes_and_relationships">28.6.4. Creating nodes and relationships</a></span></dt><dt><span class="section"><a href="shell-commands.html#_setting_renaming_and_removing_properties">28.6.5. Setting, renaming and removing properties</a></span></dt><dt><span class="section"><a href="shell-commands.html#_deleting_nodes_and_relationships">28.6.6. Deleting nodes and relationships</a></span></dt><dt><span class="section"><a href="shell-commands.html#shell-env-vars">28.6.7. Environment variables</a></span></dt><dt><span class="section"><a href="shell-commands.html#_executing_groovy_python_scripts">28.6.8. Executing groovy/python scripts</a></span></dt><dt><span class="section"><a href="shell-commands.html#_traverse">28.6.9. Traverse</a></span></dt><dt><span class="section"><a href="shell-commands.html#_query_with_cypher">28.6.10. Query with Cypher</a></span></dt><dt><span class="section"><a href="shell-commands.html#shell-listing-indexes-and-constraints">28.6.11. Listing Indexes and Constraints</a></span></dt><dt><span class="section"><a href="shell-commands.html#shell-legacy-indexing">28.6.12. Legacy Indexing</a></span></dt><dt><span class="section"><a href="shell-commands.html#_transactions">28.6.13. Transactions</a></span></dt><dt><span class="section"><a href="shell-commands.html#_dumping_the_database_or_a_cypher_result_to_cypher_statements">28.6.14. Dumping the database or a cypher result to Cypher statements</a></span></dt></dl></div><p>The shell is modeled after Unix shells like bash that you use to walk around your local file system.
It has some of the same commands, like <code class="literal">cd</code> and <code class="literal">ls</code>.
When you first start the shell (see instructions above), you will get a list of all the available commands.
Use <code class="literal">man &lt;command&gt;</code> to get more info about a particular command. Some notes:</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="comments"></a>28.6.1. Comments</h3></div></div></div><p>Single line comments, which will be ignored, can be made by using the prefix <code class="literal">//</code>. Example:</p><pre class="programlisting brush: plain">// This is a comment</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="shell-current-pos"></a>28.6.2. Current node/relationship and path</h3></div></div></div><p>You have a current node/relationship and a "current path" (like a current working directory in bash) that you’ve traversed so far.
When the shell first starts you are not positioned on any entity, but you can <code class="literal">cd</code> your way through the graph (check your current path at any time with the <code class="literal">pwd</code> command).
<code class="literal">cd</code> can be used in different ways:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">cd &lt;node-id&gt;</code> will traverse one relationship to the supplied node id. The node must have a direct relationship to the current node.
</li><li class="listitem">
<code class="literal">cd -a &lt;node-id&gt;</code> will do an absolute path change, which means the supplied node doesn’t have to have a direct relationship to the current node.
</li><li class="listitem">
<code class="literal">cd -r &lt;relationship-id&gt;</code> will traverse to a relationship instead of a node. The relationship must have the current node as either start or end point. To see the relationship ids use the <code class="literal">ls -vr</code> command on nodes.
</li><li class="listitem">
<code class="literal">cd -ar &lt;relationship-id&gt;</code> will do an absolute path change which means the relationship can be any relationship in the graph.
</li><li class="listitem">
<code class="literal">cd ..</code> will traverse back one step to the previous location, removing the last path item from your current path (<code class="literal">pwd</code>).
</li><li class="listitem">
<code class="literal">cd start</code> <span class="emphasis"><em>(only if your current location is a relationship)</em></span>. Traverses to the start node of the relationship.
</li><li class="listitem">
<code class="literal">cd end</code> <span class="emphasis"><em>(only if your current location is a relationship)</em></span>. Traverses to the end node of the relationship.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="shell-listing"></a>28.6.3. Listing the contents of a node/relationship</h3></div></div></div><p>List contents of the current node/relationship (or any other node) with the <code class="literal">ls</code> command.
Please note that it will give an empty output if the current node/relationship has no properties or relationships (for example in the case of a brand new graph).
<code class="literal">ls</code> can take a node id as argument as well as filters, see <a class="xref" href="shell-filters.html" title="28.4. Filters">Section 28.4, “Filters”</a> and for information about how to specify direction see <a class="xref" href="shell-options-enum.html" title="28.3. Enum options">Section 28.3, “Enum options”</a>.
Use <code class="literal">man ls</code> for more info.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_creating_nodes_and_relationships"></a>28.6.4. Creating nodes and relationships</h3></div></div></div><p>You create new nodes by connecting them with relationships to the current node.
For example, <code class="literal">mkrel -t A_RELATIONSHIP_TYPE -d OUTGOING -c</code> will create a new node (<code class="literal">-c</code>) and draw to it an <code class="literal">OUTGOING</code> relationship of type <code class="literal">A_RELATIONSHIP_TYPE</code> from the current node.
If you already have two nodes which you’d like to draw a relationship between (without creating a new node) you can do for example, <code class="literal">mkrel -t A_RELATIONSHIP_TYPE -d OUTGOING -n &lt;other-node-id&gt;</code> and it will just create a new relationship between the current node and that other node.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_setting_renaming_and_removing_properties"></a>28.6.5. Setting, renaming and removing properties</h3></div></div></div><p>Property operations are done with the <code class="literal">set</code>, <code class="literal">mv</code> and <code class="literal">rm</code> commands.
These commands operates on the current node/relationship.</p><p>Use <code class="literal">set &lt;key&gt; &lt;value&gt;</code>, optionally with the <code class="literal">-t</code> option (for value type), to set a property.
Supports every type of value that Neo4j supports. Examples of a property of type <code class="literal">int</code>:</p><pre class="programlisting brush: plain">$ set -t int age 29</pre><p>And an example of setting a <code class="literal">double[]</code> property:</p><pre class="programlisting brush: plain">$ set -t double[] my_values [1.4,12.2,13]</pre><p>Example of setting a <code class="literal">String</code> property containing a JSON string:</p><pre class="programlisting brush: plain">mkrel -c -d i -t DOMAIN_OF --np "{'app':'foobar'}"</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">rm &lt;key&gt;</code> removes a property.
</li><li class="listitem">
<code class="literal">mv &lt;key&gt; &lt;new-key&gt;</code> renames a property from one key to another.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_deleting_nodes_and_relationships"></a>28.6.6. Deleting nodes and relationships</h3></div></div></div><p>Deletion of nodes and relationships is done with the <code class="literal">rmnode</code> and <code class="literal">rmrel</code> commands.
<code class="literal">rmnode</code> can delete nodes, if the node to be deleted still has relationships they can also be deleted by supplying -f option.
<code class="literal">rmrel</code> can delete relationships, it tries to ensure connectedness in the graph, but relationships can be deleted regardless with the -f option.
<code class="literal">rmrel</code> can also delete the node on the other side of the deleted relationship if it’s left with no more relationships, see -d option.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="shell-env-vars"></a>28.6.7. Environment variables</h3></div></div></div><p>The shell uses environment variables a-la bash to keep session information, such as the current path and more.
The commands for this mimics the bash commands <code class="literal">export</code> and <code class="literal">env</code>. For example you can at anytime issue a <code class="literal">export STACKTRACES=true</code> command to set the <code class="literal">STACKTRACES</code> environment variable to <code class="literal">true</code>. This will then result in stacktraces being printed if an exception or error should occur.
Allowed values are all parseable JSON strings, so maps <code class="literal">{age:10,name:"Mattias"}</code> and arrays <code class="literal">[1,2,3]</code> are also supported.</p><p>Variables can also be assigned to each other. E.g. <code class="literal">a=b</code> will result in <code class="literal">a</code> containing the value of <code class="literal">b</code>.</p><p>This becomes especially interesting as all shell variables are automatically passed to cypher statements as parameters. That makes it easy to query for certain start nodes or
 create nodes and relationships with certain provided properties (as maps).</p><p>Values are removed by setting them to <code class="literal">null</code> or an empty value. List environment variables using <code class="literal">env</code></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_executing_groovy_python_scripts"></a>28.6.8. Executing groovy/python scripts</h3></div></div></div><p>The shell has support for executing scripts, such as <a class="ulink" href="http://groovy.codehaus.org" target="_top">Groovy</a> and <a class="ulink" href="http://www.python.org" target="_top">Python</a> (via <a class="ulink" href="http://www.jython.org" target="_top">Jython</a>).
As of now the scripts (*.groovy, *.py) must exist on the server side and gets called from a client with for example, <code class="literal">gsh --renamePerson 1234 "Mathias" "Mattias" --doSomethingElse</code> where the scripts renamePerson.groovy and doSomethingElse.groovy must exist on the server side in any of the paths given by the <code class="literal">GSH_PATH</code> environment variable (defaults to .:src:src/script). This variable is like the java classpath, separated by a <code class="literal">:</code>. The python/jython scripts can be executed with the <code class="literal">jsh</code> in a similar fashion, however the scripts have the .py extension and the environment variable for the paths is <code class="literal">JSH_PATH</code>.</p><p>When writing the scripts assume that there’s made available an <code class="literal">args</code> variable (a String[]) which contains the supplied arguments.
In the case of the <code class="literal">renamePerson</code> example above the array would contain <code class="literal">["1234", "Mathias", "Mattias"]</code>.
Also please write your outputs to the <code class="literal">out</code> variable, such as <code class="literal">out.println( "My tracing text" )</code> so that it will be printed at the shell client instead of the server.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_traverse"></a>28.6.9. Traverse</h3></div></div></div><p>You can traverse the graph with the <code class="literal">trav</code> command which allows for simple traversing from the current node.
You can supply which relationship types (w/ regex matching) and optionally direction as well as property filters for matching nodes.
In addition to that you can supply a command line to execute for each match.
An example: <code class="literal">trav -o depth -r KNOWS:both,HAS_.*:incoming -c "ls $n"</code>.
Which means traverse depth first for relationships with type <code class="literal">KNOWS</code> disregarding direction and incoming relationships with type matching <code class="literal">HAS_.\*</code> and do a <code class="literal">ls &lt;matching node&gt;</code> for each match. The node filtering is supplied with the <code class="literal">-f</code> option, see <a class="xref" href="shell-filters.html" title="28.4. Filters">Section 28.4, “Filters”</a>.
See <a class="xref" href="shell-options-enum.html" title="28.3. Enum options">Section 28.3, “Enum options”</a> for the traversal order option. Even relationship types/directions are supplied using the same format as filters.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_query_with_cypher"></a>28.6.10. Query with Cypher</h3></div></div></div><p>You can use Cypher to query the graph. For that, use the <code class="literal">match</code> or <code class="literal">start</code> command.
You can also use <code class="literal">create</code> statements to create nodes and relationships and use the <code class="literal">cypher VERSION</code> prefix to select a certain cypher version.</p><div class="tip" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/icons/admon/tip.png" /></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>Cypher queries need to be terminated by a semicolon <code class="literal">;</code>.</p></td></tr></table></div><p>Cypher commands are given all shell variables as parameters and the special <code class="literal">self</code> parameter for the current node or relationship.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">start n = node(0) return n;</code> will give you a listing of the node with ID 0
</li><li class="listitem">
<code class="literal">cypher 1.9 start n = node(0) return n;</code> will execute the query with Cypher version 1.9
</li><li class="listitem">
<code class="literal">START n = node({self}) MATCH (n)-[:KNOWS]→(friend) RETURN friend;</code> will
return the nodes connected to the current node.
</li><li class="listitem">
<code class="literal">START n=node({me}) CREATE friend={props}, (me)-[r:KNOWS]→(friend);</code> will
create the friend and the relationship according to the variables available.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="shell-listing-indexes-and-constraints"></a>28.6.11. Listing Indexes and Constraints</h3></div></div></div><p>The <code class="literal">schema</code> command allows to list all existing indexes and constraints together with their current status.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/admon/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This command does not list legacy indexes. For working with legacy indexes, please see <a class="xref" href="shell-commands.html#shell-legacy-indexing" title="28.6.12. Legacy Indexing">Section 28.6.12, “Legacy Indexing”</a>.</p></td></tr></table></div><p>List all indexes and constraints:</p><pre class="programlisting brush: plain">schema</pre><p>List indexes or constraints on <code class="literal">:Person</code> nodes for the property <code class="literal">name</code>:</p><pre class="programlisting brush: plain">schema -l :Person -p name</pre><p>The <code class="literal">schema</code> command supports the following parameters:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">-l :Label</code> only list indexes or constraints for the given label <code class="literal">:Label</code>
</li><li class="listitem">
<code class="literal">-p propertyKey</code> only list indexes or constraints for the given property key <code class="literal">propertyKey</code>
</li><li class="listitem">
<code class="literal">-v</code> if an index is in the <code class="literal">FAILED</code> state, print a verbose error cause if available
</li></ul></div><p>Indexes and constraints can be created or removed using Cypher or the Java Core API. They are updated automatically
whenever the graph is changed.  See <a class="xref" href="graphdb-neo4j-schema.html" title="3.7. Schema">Section 3.7, “Schema”</a> for more information.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="shell-legacy-indexing"></a>28.6.12. Legacy Indexing</h3></div></div></div><p>It’s possible to query and manipulate legacy indexes via the index command.</p><p>Example: <code class="literal">index -i persons name</code> (will index the name for the current node or relationship in the "persons" legacy index).</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">-g</code> will do exact lookup in the legacy index and display hits. You can supply <code class="literal">-c</code> with a command to be executed for each hit.
</li><li class="listitem">
<code class="literal">-q</code> will ask the legacy index a query and display hits. You can supply <code class="literal">-c</code> with a command to be executed for each hit.
</li><li class="listitem">
<code class="literal">--cd</code> will change current location to the hit from the query. It’s just a convenience for using the <code class="literal">-c</code> option.
</li><li class="listitem">
<code class="literal">--ls</code> will do a listing of the contents for each hit. It’s just a convenience for using the <code class="literal">-c</code> option.
</li><li class="listitem">
<code class="literal">-i</code> will index a key-value pair into a legacy index for the current node/relationship. If no value is given the property value for that key for the current node is used as value.
</li><li class="listitem">
<code class="literal">-r</code> will remove a key-value pair (if it exists) from a legacy index for the current node/relationship. Key and value are optional.
</li><li class="listitem">
<code class="literal">-t</code> will set the legacy index type to work with, for example <code class="literal">index -t Relationship --delete friends</code> will delete the <code class="literal">friends</code> relationship index.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_transactions"></a>28.6.13. Transactions</h3></div></div></div><p>It is useful to be able to test changes, and then being able to commit or rollback said changes.</p><p>Transactions can be nested. With a nested transaction, a commit does not write any changes to disk, except for the
top level transaction. A rollback, however works regardless of the level of the transaction. It will roll back
all open transactions.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">begin transaction</code>  Starts a transaction.
</li><li class="listitem">
<code class="literal">commit</code> Commits a transaction.
</li><li class="listitem">
<code class="literal">rollback</code> Rollbacks all open transactions.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_dumping_the_database_or_a_cypher_result_to_cypher_statements"></a>28.6.14. Dumping the database or a cypher result to Cypher statements</h3></div></div></div><p>As a simple way of exporting a database or a subset of it, the <code class="literal">dump</code> command converts the graph of a Cypher result or the whole database into a single Cypher <code class="literal">create</code> statement.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/admon/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Constraint export is not yet supported.</p></td></tr></table></div><p>Examples:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">dump</code> dumps the whole database as single cypher create statement
</li><li class="listitem">
<code class="literal">dump START n=node({self}) MATCH p=(n)-[r:KNOWS*]→(m) RETURN n,r,m;</code> dumps the transitive friendship graph of the current node.
</li><li class="listitem">
<code class="literal">neo4j-shell -path db1 -c dump START n=node:node_auto_index(name='Mattias\') MATCH p=(n)-[r:KNOWS]→(m) RETURN p; | neo4j-shell -path db2</code>
  imports the subgraph of the first database (db1) into the second (db2)
</li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_example_dump_scripts"></a>Example Dump Scripts</h4></div></div></div><pre class="programlisting brush: bash"> # create a new node and go to it
 neo4j-sh (?)$ mknode --cd --np "{'name':'Neo'}"

 # create a relationship
 neo4j-sh (Neo,0)$ mkrel -c -d i -t LIKES --np "{'app':'foobar'}"

 # Export the cypher statement results
 neo4j-sh (Neo,0)$ dump START n=node({self}) MATCH (n)-[r]-(m) return n,r,m;
 begin
 create (_0 {`name`:"Neo"})
 create (_1 {`app`:"foobar"})
 create _1-[:`LIKES`]-&gt;_0
 ;
 commit</pre><pre class="programlisting brush: bash"> # create an index
 neo4j-sh (?)$ create index on :Person(name);
 +-------------------+
 | No data returned. |
 +-------------------+
 Indexes added: 1
 1120 ms


 # create one labeled node and a relationship
 neo4j-sh (?)$ create (m:Person:Hacker {name:'Mattias'}), (m)-[:KNOWS]-&gt;(m);
 +-------------------+
 | No data returned. |
 +-------------------+
 Nodes created: 1
 Relationships created: 1
 Properties set: 1
 Labels added: 2
 268 ms


 # Export the whole database including indexes
 neo4j-sh (?)$ dump
 begin
 create index on :`Person`(`name`);
 create (_0:`Person`:`Hacker` {`name`:"Mattias"})
 create _0-[:`KNOWS`]-&gt;_0
 ;
 commit</pre></div></div></div><HR xmlns=""></HR><a xmlns="" href="ln-idp218960.html"><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">Copyright © 2013 Neo Technology</p></a><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="shell-titles.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="shell.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="shell-sample-session.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>
