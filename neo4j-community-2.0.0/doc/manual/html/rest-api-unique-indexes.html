<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>19.19. Unique Indexing</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.76.1" /><link rel="home" href="index.html" title="The Neo4j Manual v2.0.0" /><link rel="up" href="rest-api.html" title="Chapter 19. REST API" /><link rel="prev" href="rest-api-indexes.html" title="19.18. Legacy indexing" /><link rel="next" href="rest-api-auto-indexes.html" title="19.20. Legacy Automatic Indexes" /><link rel="preface" href="preface.html" title="Preface" /><link rel="part" href="introduction.html" title="Part I. Introduction" /><link rel="chapter" href="introduction-highlights.html" title="Chapter 1. Neo4j Highlights" /><link rel="chapter" href="graphdb-concepts.html" title="Chapter 2. Graph Database Concepts" /><link rel="chapter" href="graphdb-neo4j.html" title="Chapter 3. The Neo4j Graph Database" /><link rel="part" href="tutorials.html" title="Part II. Tutorials" /><link rel="chapter" href="tutorials-cypher.html" title="Chapter 4. Getting started with Cypher" /><link rel="chapter" href="data-modeling-examples.html" title="Chapter 5. Data Modeling Examples" /><link rel="chapter" href="languages.html" title="Chapter 6. Languages" /><link rel="part" href="cypher-query-lang.html" title="Part III. Cypher Query Language" /><link rel="chapter" href="cypher-intro.html" title="Chapter 7. Introduction" /><link rel="chapter" href="query-syntax.html" title="Chapter 8. Syntax" /><link rel="chapter" href="query-general.html" title="Chapter 9. General Clauses" /><link rel="chapter" href="query-read.html" title="Chapter 10. Reading Clauses" /><link rel="chapter" href="query-write.html" title="Chapter 11. Writing Clauses" /><link rel="chapter" href="query-function.html" title="Chapter 12. Functions" /><link rel="chapter" href="cypher-schema.html" title="Chapter 13. Schema" /><link rel="chapter" href="examples-from-sql-to-cypher.html" title="Chapter 14. From SQL to Cypher" /><link rel="part" href="reference-documentation.html" title="Part IV. Reference" /><link rel="chapter" href="capabilities.html" title="Chapter 15. Capabilities" /><link rel="chapter" href="transactions.html" title="Chapter 16. Transaction Management" /><link rel="chapter" href="import.html" title="Chapter 17. Data Import" /><link rel="chapter" href="graph-algo.html" title="Chapter 18. Graph Algorithms" /><link rel="chapter" href="rest-api.html" title="Chapter 19. REST API" /><link rel="chapter" href="deprecations.html" title="Chapter 20. Deprecations" /><link rel="part" href="operations.html" title="Part V. Operations" /><link rel="chapter" href="deployment.html" title="Chapter 21. Installation &amp; Deployment" /><link rel="chapter" href="embedded-configuration.html" title="Chapter 22. Configuration &amp; Performance" /><link rel="chapter" href="ha.html" title="Chapter 23. High Availability" /><link rel="chapter" href="operations-backup.html" title="Chapter 24. Backup" /><link rel="chapter" href="operations-security.html" title="Chapter 25. Security" /><link rel="chapter" href="operations-monitoring.html" title="Chapter 26. Monitoring" /><link rel="part" href="tools.html" title="Part VI. Tools" /><link rel="chapter" href="tools-webadmin.html" title="Chapter 27. Web Interface" /><link rel="chapter" href="shell.html" title="Chapter 28. Neo4j Shell" /><link rel="part" href="community.html" title="Part VII. Community" /><link rel="chapter" href="community-support.html" title="Chapter 29. Community Support" /><link rel="chapter" href="community-contributing.html" title="Chapter 30. Contributing to Neo4j" /><link rel="part" href="advanced-usage.html" title="Part VIII. Advanced Usage" /><link rel="chapter" href="server-extending.html" title="Chapter 31. Extending the Neo4j Server" /><link rel="chapter" href="tutorials-java-embedded.html" title="Chapter 32. Using Neo4j embedded in Java applications" /><link rel="chapter" href="tutorial-traversal.html" title="Chapter 33. The Traversal Framework" /><link rel="chapter" href="indexing.html" title="Chapter 34. Legacy Indexing" /><link rel="chapter" href="batchinsert.html" title="Chapter 35. Batch Insertion" /><link rel="appendix" href="manpages.html" title="Appendix A. Manpages" /><link rel="refentry" href="re01.html" title="neo4j" /><link rel="refentry" href="re02.html" title="neo4j-installer" /><link rel="refentry" href="re03.html" title="neo4j-shell" /><link rel="refentry" href="re04.html" title="neo4j-backup" /><link rel="refentry" href="re05.html" title="neo4j-arbiter" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-node-create" title="19.19.1. Get or create unique node (create)" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-node-existing" title="19.19.2. Get or create unique node (existing)" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-create-a-unique-node-or-return-fail-create" title="19.19.3. Create a unique node or return fail (create)" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-create-a-unique-node-or-return-fail-fail" title="19.19.4. Create a unique node or return fail (fail)" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-add-an-existing-node-to-unique-index-not-indexed" title="19.19.5. Add an existing node to unique index (not indexed)" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-add-an-existing-node-to-unique-index-already-indexed" title="19.19.6. Add an existing node to unique index (already indexed)" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-relationship-create" title="19.19.7. Get or create unique relationship (create)" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-relationship-existing" title="19.19.8. Get or create unique relationship (existing)" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-create-a-unique-relationship-or-return-fail-create" title="19.19.9. Create a unique relationship or return fail (create)" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-create-a-unique-relationship-or-return-fail-fail" title="19.19.10. Create a unique relationship or return fail (fail)" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-add-an-existing-relationship-to-a-unique-index-not-indexed" title="19.19.11. Add an existing relationship to a unique index (not indexed)" /><link rel="subsection" href="rest-api-unique-indexes.html#rest-api-add-an-existing-relationship-to-a-unique-index-already-indexed" title="19.19.12. Add an existing relationship to a unique index (already indexed)" /><link rel="copyright" href="ln-idp218960.html" title="License: Creative Commons 3.0" />


<!-- favicon -->

<link rel="shortcut icon" href="http://neo4j.org/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="icon" href="http://neo4j.org/favicon.ico" type="image/x-icon" />

<!-- style -->

<link href="css/shCore.css" rel="stylesheet" type="text/css" />
<link href="css/shCoreEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/shThemeEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/neo.css" rel="stylesheet" type="text/css" />

<!-- Syntax Highlighter -->

<script type="text/javascript" src="js/shCore.js"></script>
<script type="text/javascript" src="js/shBrushJava.js"></script>
<script type="text/javascript" src="js/shBrushJScript.js"></script>
<script type="text/javascript" src="js/shBrushBash.js"></script>
<script type="text/javascript" src="js/shBrushPlain.js"></script>
<script type="text/javascript" src="js/shBrushXml.js"></script>
<script type="text/javascript" src="js/shBrushGroovy.js"></script>
<script type="text/javascript" src="js/shBrushCypher.js"></script>
<script type="text/javascript" src="js/shBrushScala.js"></script>
<script type="text/javascript" src="js/shBrushSql.js"></script>
<script type="text/javascript" src="js/shBrushPython.js"></script>
<script type="text/javascript" src="js/shBrushProperties.js"></script>

<!-- activate when needed
<script type="text/javascript" src="js/shBrushRuby.js"></script>
<script type="text/javascript" src="js/shBrushCSharp.js"></script>
-->
 
<script type="text/javascript">
  SyntaxHighlighter.defaults['tab-size'] = 4;
  SyntaxHighlighter.defaults['gutter'] = false;
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all()
</script>

<!-- JQuery -->

<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>

<!-- Replace SVG for browsers that lack support. -->
<script type="text/javascript" src="js/svgreplacer.js"></script>

<!-- Image Scaler -->

<script type="text/javascript" src="js/imagescaler.js"></script>

<!-- Table Styler -->

<script type="text/javascript" src="js/tablestyler.js"></script>

<!-- Version -->

<script type="text/javascript" src="js/version.js"></script>

<!-- Offline Sidebar -->

<script type="text/javascript" src="js/sidebar.js"></script>


<div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">The Neo4j Manual</a></span> &gt; <span class="breadcrumb-link"><a href="reference-documentation.html">Reference</a></span> &gt; <span class="breadcrumb-link"><a href="rest-api.html">REST API</a></span> &gt; <span class="breadcrumb-node">Unique Indexing</span></div></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="rest-api-indexes.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="rest-api-auto-indexes.html">Next</a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="rest-api-unique-indexes"></a>19.19. Unique Indexing</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-node-create">19.19.1. Get or create unique node (create)</a></span></dt><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-node-existing">19.19.2. Get or create unique node (existing)</a></span></dt><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-create-a-unique-node-or-return-fail-create">19.19.3. Create a unique node or return fail (create)</a></span></dt><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-create-a-unique-node-or-return-fail-fail">19.19.4. Create a unique node or return fail (fail)</a></span></dt><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-add-an-existing-node-to-unique-index-not-indexed">19.19.5. Add an existing node to unique index (not indexed)</a></span></dt><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-add-an-existing-node-to-unique-index-already-indexed">19.19.6. Add an existing node to unique index (already indexed)</a></span></dt><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-relationship-create">19.19.7. Get or create unique relationship (create)</a></span></dt><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-relationship-existing">19.19.8. Get or create unique relationship (existing)</a></span></dt><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-create-a-unique-relationship-or-return-fail-create">19.19.9. Create a unique relationship or return fail (create)</a></span></dt><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-create-a-unique-relationship-or-return-fail-fail">19.19.10. Create a unique relationship or return fail (fail)</a></span></dt><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-add-an-existing-relationship-to-a-unique-index-not-indexed">19.19.11. Add an existing relationship to a unique index (not indexed)</a></span></dt><dt><span class="section"><a href="rest-api-unique-indexes.html#rest-api-add-an-existing-relationship-to-a-unique-index-already-indexed">19.19.12. Add an existing relationship to a unique index (already indexed)</a></span></dt></dl></div><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/admon/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>As of Neo4j 2.0, unique constraints have been added.
These make Neo4j enforce the uniqueness, guaranteeing that uniqueness is maintained.
See <a class="xref" href="graphdb-neo4j-schema.html#graphdb-neo4j-schema-constraints" title="3.7.2. Constraints">Section 3.7.2, “Constraints”</a> for details about this.
For most cases, the unique constraints should be used rather than the features described below.</p></td></tr></table></div><p>For uniqueness enforcements, there are two modes:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
URL Parameter <code class="literal">uniqueness=get_or_create</code>: Create a new node/relationship and index it if no existing one can be found. If an existing node/relationship is found, discard the sent data and return the existing node/relationship.
</li><li class="listitem">
URL Parameter <code class="literal">uniqueness=create_or_fail</code>: Create a new node/relationship if no existing one can be found in the index. If an existing node/relationship is found, return a conflict error.
</li></ul></div><p>For more information, see <a class="xref" href="transactions-unique-nodes.html" title="16.6. Creating unique nodes">Section 16.6, “Creating unique nodes”</a>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-get-or-create-unique-node-create"></a>19.19.1. Get or create unique node (create)</h3></div></div></div><p>The node is created if it doesn’t exist in the unique index already.</p><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/people?uniqueness=get_or_create</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "key" : "name",
  "value" : "Tobias",
  "properties" : {
    "name" : "Tobias",
    "sequence" : 1
  }
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/node/people/name/Tobias/98</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/98/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/98/labels",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/98/relationships/all/{-list|&amp;|types}",
  "traverse" : "http://localhost:7474/db/data/node/98/traverse/{returnType}",
  "self" : "http://localhost:7474/db/data/node/98",
  "property" : "http://localhost:7474/db/data/node/98/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/98/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/98/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/98/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/98/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/98/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/98/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/98/relationships/in/{-list|&amp;|types}",
  "data" : {
    "sequence" : 1,
    "name" : "Tobias"
  },
  "indexed" : "http://localhost:7474/db/data/index/node/people/name/Tobias/98"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-get-or-create-unique-node-existing"></a>19.19.2. Get or create unique node (existing)</h3></div></div></div><p>Here,
a node is not created but the existing unique node returned, since another node
is indexed with the same data already. The node data returned is then that of the
already existing node.</p><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/people?uniqueness=get_or_create</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "key" : "name",
  "value" : "Peter",
  "properties" : {
    "name" : "Peter",
    "sequence" : 2
  }
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/node/people/name/Peter/88</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/88/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/88/labels",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/88/relationships/all/{-list|&amp;|types}",
  "traverse" : "http://localhost:7474/db/data/node/88/traverse/{returnType}",
  "self" : "http://localhost:7474/db/data/node/88",
  "property" : "http://localhost:7474/db/data/node/88/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/88/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/88/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/88/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/88/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/88/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/88/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/88/relationships/in/{-list|&amp;|types}",
  "data" : {
    "sequence" : 1,
    "name" : "Peter"
  },
  "indexed" : "http://localhost:7474/db/data/index/node/people/name/Peter/88"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-create-a-unique-node-or-return-fail-create"></a>19.19.3. Create a unique node or return fail (create)</h3></div></div></div><p>Here, in case
of an already existing node, an error should be returned. In this
example, no existing indexed node is found and a new node is created.</p><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/people?uniqueness=create_or_fail</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "key" : "name",
  "value" : "Tobias",
  "properties" : {
    "name" : "Tobias",
    "sequence" : 1
  }
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/node/people/name/Tobias/97</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/97/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/97/labels",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/97/relationships/all/{-list|&amp;|types}",
  "traverse" : "http://localhost:7474/db/data/node/97/traverse/{returnType}",
  "self" : "http://localhost:7474/db/data/node/97",
  "property" : "http://localhost:7474/db/data/node/97/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/97/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/97/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/97/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/97/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/97/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/97/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/97/relationships/in/{-list|&amp;|types}",
  "data" : {
    "sequence" : 1,
    "name" : "Tobias"
  },
  "indexed" : "http://localhost:7474/db/data/index/node/people/name/Tobias/97"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-create-a-unique-node-or-return-fail-fail"></a>19.19.4. Create a unique node or return fail (fail)</h3></div></div></div><p>Here, in case
of an already existing node, an error should be returned. In this
example, an existing node indexed with the same data
is found and an error is returned.</p><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/people?uniqueness=create_or_fail</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "key" : "name",
  "value" : "Peter",
  "properties" : {
    "name" : "Peter",
    "sequence" : 2
  }
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">409:</code></strong></span> <code class="literal">Conflict</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/81/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/81/labels",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/81/relationships/all/{-list|&amp;|types}",
  "traverse" : "http://localhost:7474/db/data/node/81/traverse/{returnType}",
  "self" : "http://localhost:7474/db/data/node/81",
  "property" : "http://localhost:7474/db/data/node/81/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/81/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/81/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/81/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/81/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/81/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/81/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/81/relationships/in/{-list|&amp;|types}",
  "data" : {
    "sequence" : 1,
    "name" : "Peter"
  },
  "indexed" : "http://localhost:7474/db/data/index/node/people/name/Peter/81"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-add-an-existing-node-to-unique-index-not-indexed"></a>19.19.5. Add an existing node to unique index (not indexed)</h3></div></div></div><p>Associates a node with the given key/value pair in the given unique
index.</p><p>In this example, we are using <code class="literal">create_or_fail</code> uniqueness.</p><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/favorites?uniqueness=create_or_fail</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "value" : "some value",
  "uri" : "http://localhost:7474/db/data/node/92",
  "key" : "some-key"
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/node/favorites/some-key/some%20value/93</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/93/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/93/labels",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/93/relationships/all/{-list|&amp;|types}",
  "traverse" : "http://localhost:7474/db/data/node/93/traverse/{returnType}",
  "self" : "http://localhost:7474/db/data/node/93",
  "property" : "http://localhost:7474/db/data/node/93/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/93/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/93/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/93/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/93/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/93/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/93/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/93/relationships/in/{-list|&amp;|types}",
  "data" : {
    "some-key" : "some value"
  },
  "indexed" : "http://localhost:7474/db/data/index/node/favorites/some-key/some%20value/93"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-add-an-existing-node-to-unique-index-already-indexed"></a>19.19.6. Add an existing node to unique index (already indexed)</h3></div></div></div><p>In this case, the node already exists in the index, and thus we get a <code class="literal">HTTP 409</code> status response,
as we have set the uniqueness to <code class="literal">create_or_fail</code>.</p><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/favorites?uniqueness=create_or_fail</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "value" : "some value",
  "uri" : "http://localhost:7474/db/data/node/95",
  "key" : "some-key"
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">409:</code></strong></span> <code class="literal">Conflict</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/96/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/96/labels",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/96/relationships/all/{-list|&amp;|types}",
  "traverse" : "http://localhost:7474/db/data/node/96/traverse/{returnType}",
  "self" : "http://localhost:7474/db/data/node/96",
  "property" : "http://localhost:7474/db/data/node/96/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/96/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/96/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/96/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/96/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/96/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/96/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/96/relationships/in/{-list|&amp;|types}",
  "data" : {
    "some-key" : "some value"
  },
  "indexed" : "http://localhost:7474/db/data/index/node/favorites/some-key/some%20value/96"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-get-or-create-unique-relationship-create"></a>19.19.7. Get or create unique relationship (create)</h3></div></div></div><p>Create a unique relationship in an index.
If a relationship matching the given key and value already exists in the index, it will be returned.
If not, a new relationship will be created.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/admon/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The type and direction of the relationship is not regarded when determining uniqueness.</p></td></tr></table></div><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/MyIndex/?uniqueness=get_or_create</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "key" : "name",
  "value" : "Tobias",
  "start" : "http://localhost:7474/db/data/node/231",
  "end" : "http://localhost:7474/db/data/node/232",
  "type" : "knowledge"
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/relationship/MyIndex/name/Tobias/170</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "start" : "http://localhost:7474/db/data/node/231",
  "property" : "http://localhost:7474/db/data/relationship/170/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/170",
  "properties" : "http://localhost:7474/db/data/relationship/170/properties",
  "type" : "knowledge",
  "end" : "http://localhost:7474/db/data/node/232",
  "data" : {
    "name" : "Tobias"
  },
  "indexed" : "http://localhost:7474/db/data/index/relationship/MyIndex/name/Tobias/170"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-get-or-create-unique-relationship-existing"></a>19.19.8. Get or create unique relationship (existing)</h3></div></div></div><p>Here, in case
of an already existing relationship, the sent data is ignored and the
existing relationship returned.</p><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/rels?uniqueness=get_or_create</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "key" : "name",
  "value" : "Peter",
  "start" : "http://localhost:7474/db/data/node/235",
  "end" : "http://localhost:7474/db/data/node/236",
  "type" : "KNOWS"
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "start" : "http://localhost:7474/db/data/node/233",
  "property" : "http://localhost:7474/db/data/relationship/171/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/171",
  "properties" : "http://localhost:7474/db/data/relationship/171/properties",
  "type" : "KNOWS",
  "end" : "http://localhost:7474/db/data/node/234",
  "data" : {
  },
  "indexed" : "http://localhost:7474/db/data/index/relationship/rels/name/Peter/171"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-create-a-unique-relationship-or-return-fail-create"></a>19.19.9. Create a unique relationship or return fail (create)</h3></div></div></div><p>Here, in case
of an already existing relationship, an error should be returned. In this
example, no existing relationship is found and a new relationship is created.</p><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/rels?uniqueness=create_or_fail</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "key" : "name",
  "value" : "Tobias",
  "start" : "http://localhost:7474/db/data/node/243",
  "end" : "http://localhost:7474/db/data/node/244",
  "type" : "KNOWS"
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/relationship/rels/name/Tobias/174</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "start" : "http://localhost:7474/db/data/node/243",
  "property" : "http://localhost:7474/db/data/relationship/174/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/174",
  "properties" : "http://localhost:7474/db/data/relationship/174/properties",
  "type" : "KNOWS",
  "end" : "http://localhost:7474/db/data/node/244",
  "data" : {
    "name" : "Tobias"
  },
  "indexed" : "http://localhost:7474/db/data/index/relationship/rels/name/Tobias/174"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-create-a-unique-relationship-or-return-fail-fail"></a>19.19.10. Create a unique relationship or return fail (fail)</h3></div></div></div><p>Here, in case
of an already existing relationship, an error should be returned. In this
example, an existing relationship is found and an error is returned.</p><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/rels?uniqueness=create_or_fail</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "key" : "name",
  "value" : "Peter",
  "start" : "http://localhost:7474/db/data/node/223",
  "end" : "http://localhost:7474/db/data/node/224",
  "type" : "KNOWS"
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">409:</code></strong></span> <code class="literal">Conflict</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "start" : "http://localhost:7474/db/data/node/221",
  "property" : "http://localhost:7474/db/data/relationship/166/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/166",
  "properties" : "http://localhost:7474/db/data/relationship/166/properties",
  "type" : "KNOWS",
  "end" : "http://localhost:7474/db/data/node/222",
  "data" : {
  },
  "indexed" : "http://localhost:7474/db/data/index/relationship/rels/name/Peter/166"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-add-an-existing-relationship-to-a-unique-index-not-indexed"></a>19.19.11. Add an existing relationship to a unique index (not indexed)</h3></div></div></div><p>If a relationship matching the given key and value already exists in the index, it will be returned.
If not, an <code class="literal">HTTP 409</code> (conflict) status will be returned in this case, as we are using <code class="literal">create_or_fail</code>.</p><p>It’s possible to use <code class="literal">get_or_create</code> uniqueness as well.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/admon/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The type and direction of the relationship is not regarded when determining uniqueness.</p></td></tr></table></div><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/rels?uniqueness=create_or_fail</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "key" : "name",
  "value" : "Peter",
  "uri" : "http://localhost:7474/db/data/relationship/164"
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/relationship/rels/name/Peter/165</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "start" : "http://localhost:7474/db/data/node/219",
  "property" : "http://localhost:7474/db/data/relationship/165/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/165",
  "properties" : "http://localhost:7474/db/data/relationship/165/properties",
  "type" : "KNOWS",
  "end" : "http://localhost:7474/db/data/node/220",
  "data" : {
    "name" : "Peter"
  },
  "indexed" : "http://localhost:7474/db/data/index/relationship/rels/name/Peter/165"
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rest-api-add-an-existing-relationship-to-a-unique-index-already-indexed"></a>19.19.12. Add an existing relationship to a unique index (already indexed)</h3></div></div></div><p><span class="emphasis"><em>Example request</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/rels?uniqueness=create_or_fail</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "key" : "name",
  "value" : "Peter",
  "uri" : "http://localhost:7474/db/data/relationship/168"
}</pre><p><span class="emphasis"><em>Example response</em></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong"><strong><code class="literal">409:</code></strong></span> <code class="literal">Conflict</code>
</li><li class="listitem">
<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>
</li></ul></div><pre class="programlisting brush: javascript">{
  "extensions" : {
  },
  "start" : "http://localhost:7474/db/data/node/225",
  "property" : "http://localhost:7474/db/data/relationship/167/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/167",
  "properties" : "http://localhost:7474/db/data/relationship/167/properties",
  "type" : "KNOWS",
  "end" : "http://localhost:7474/db/data/node/226",
  "data" : {
  },
  "indexed" : "http://localhost:7474/db/data/index/relationship/rels/name/Peter/167"
}</pre></div></div><HR xmlns=""></HR><a xmlns="" href="ln-idp218960.html"><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">Copyright © 2013 Neo Technology</p></a><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="rest-api-indexes.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="rest-api.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="rest-api-auto-indexes.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>
